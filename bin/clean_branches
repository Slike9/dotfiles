#!/usr/bin/env bash

set -e
set -u

if [[ $1 == '-h' || $1 == '--help' ]]; then
  echo "Usage: "
  echo "  clean_branches -b release"
  exit
fi

base_branch=master

while getopts b: opt; do
  case $opt in
    b)
      base_branch=$OPTARG
      ;;
  esac
done

clean_branches=$(git branch --merged $base_branch | grep -v -e master -e staging -e "*" -e $base_branch)
for i in $clean_branches; do
  git branch -d $i
done
