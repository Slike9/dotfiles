#!/usr/bin/env bash

# Usase:
# gfs -r release_branch feature_branch

set -e
set -u

if [[ -z $1 || $1 = '-h' || $1 = '--help' ]]; then
  echo "Usage:"
  echo "gfs -r release_branch feature_branch"
  exit
fi

release_branch=master

while getopts r: opts; do
  case $opts in
    r)
      release_branch=$OPTARG
      ;;
  esac
done

shift $((OPTIND-1))

branch=$1

if [ -z "$branch" ]; then
  echo "branch name is not specified"
  exit 1
fi

echo "1. switch to $release_branch"
git checkout $release_branch

echo "2. update $release_branch"
git pull

echo "3. create branch $branch"
git checkout -b $branch
